{
    "contents" : "---\ntitle: \"Česko v Governance Report 2014\"\n---\n\n```{r package-options, include=FALSE}\nlibrary(knitr)\nopts_knit$set(root.dir='~/github/local/Charting-government/')\n```\n\n```{r Prep and load data, include=FALSE}\nlibrary(pbtools)\nlibrary(gridExtra)\nlibrary(pbtools)\n\nfile <- tempfile()\nurldata <- 'http://www.governancereport.org/fileadmin/governancereport/2014/downloads/GovReportDataset2014.csv'\nurlindex <- 'http://www.governancereport.org/fileadmin/governancereport/2014/downloads/GovRep2014Indexes.csv'\ndownload.file(urldata,destfile='./data-input/GovReport2014_data.csv')\ndownload.file(urlindex,destfile='./data-input/GovReport2014_index.csv')\nGovReportIndex2014 <- read.csv('./data-input/GovReport2014_index.csv')\nGovReportData2014 <- read.csv('./data-input/GovReport2014_data.csv')\n\ncountries <- c('Czech Republic','Poland','Slovakia','Hungary','Germany','Slovenia',\n               'Estonia','Latvia','Lithuania','United Kingdom','New Zealand',\n               'Netherlands')\n```\n\n```{r Documentation, include=FALSE}\n# CODEBOOK AT\n# http://www.governancereport.org/fileadmin/governancereport/2014/downloads/GovReportCodebook2014.pdf\n# a5010: Degree of collaboration between ministries\n# a5011: degree of coordination/collaboration within administrations\n# a5075: Overall coherence of public policies\n# a5072: Authorities capacity to adapt policies to changes in the \n# economic and social contexts\n# a5071: Is evaluation a common practice?\n# a5020: are actions of public authorities in line with a long-term strategic vision?\n# a5022: do the pub auths have capacity to encourage public and private stakeholders to work\n# towards that vision?\n# a5040: are there public or private think tanks producing ...\n# a5081: 'Is the capacity of national public authorities hampered by divisions within the State apparatus?'\n# a5074: overall coherence\n```\n\n```{r Select variables, include=FALSE}\nvariables_indiv <- c('a5010','a5011','a5074','a5020',\n                     'a5081','a5074','a5022','a5072')\n\n# INDEXES CODEBOOK AT\n# http://www.governancereport.org/fileadmin/governancereport/2014/downloads/IndexesCodebook.pdf\nvariables_index <- c('delivery_overallindex100','coordexpindex100','regqualindex100',\n                     'intelligenceindex100')\n\n# check that the country and variable names are correct in lists for filtering\nsapply(countries, function(x) x %in% GovReportData2014$country)\nsapply(variables_indiv, function(x) x %in% GovReportData2014$variable)\nsapply(variables_index, function(x) x %in% GovReportData2014$variable)\n```\n\n```{r process index data, include=FALSE}\ngrr_i <- melt(GovReportIndex2014,id.vars = 'country') %>%\n  filter(country %in% countries & variable %in% variables_index) %>%\n  group_by(country) %>%\n  mutate(mean = mean(value[variable!='delivery_overallindex100'])) %>%\n  #   mutate(mean = mean(value,na.rm = T)) %>%\n  ungroup() %>%\n  dcast(country + mean ~ variable) %>%\n  melt() %>%\n  group_by(country) %>%\n  mutate(mean = value[variable=='mean']) %>%\n  ungroup() %>%\n  group_by(variable) %>%\n  arrange(-value)\n\ngrr_i$variable <- factor(grr_i$variable, levels=c('mean',\n                                              'delivery_overallindex100',\n                                              'intelligenceindex100',\n                                              'coordexpindex100',\n                                              'regqualindex100'))\ngrr_i$variable <- revalue(grr_i$variable, c('mean'='Průměr',\n                                        'intelligenceindex100'='Analytická kapacita',\n                                        'coordexpindex100'='Kvalita koordinace',\n                                        'regqualindex100'='Kvalita regulace',\n                                        'delivery_overallindex100'='Efektivita (výsledky)'))\nvariablesCZ <- c('Analytická kapacita','Kvalita koordinace',\n                 'Kvalita regulace','Efektivita (výsledky)')\n  \ngrr_i$alphaval <- .5\ngrr_i$alphaval[grr_i$countr=='Czech Republic'] <- 1\n```\n\n```{r Chart - produce, include=FALSE}\n\nloadcustomthemes(ifgcolours,'Myriad Pro')\nggplot <- function(...) ggplot2::ggplot(...) +\n  scale_fill_manual(values=themebasecolours) +\n  scale_colour_manual(values=themebasecolours)\n\ngrr_iplots <- mapply(function(x, y) {\n  grr_i2 <- grr_i[grr_i$variable==x,]\n  grr_i2$country <- with(grr_i2, reorder(country,value))\n  grr_iplot <- ggplot(grr_i2[grr_i2$variable==x,], aes(country, value,alpha=alphaval)) +\n    geom_bar(stat='identity',position='dodge',fill=y) +\n    scale_alpha_identity() +\n    coord_flip() +\n    scale_y_continuous(limits=c(0,100),breaks=c(0,25,50,75,100)) +\n    theme(panel.grid.major.y=element_blank(),panel.grid.minor.x=element_line(),\n          axis.text.y=element_text(size=12), plot.title=element_text(size=14)) +\n    labs(title=x)\n}, variablesCZ, themebasecolours[1:4], SIMPLIFY=FALSE)\n\nargs.list <- c(grr_iplots, 2,2)\nnames(args.list) <- c(\"plot1\", \"plot2\", \"plot3\", 'plot4', \"nrow\", \"ncol\")\n```\n\n```{r Chart - display, echo=FALSE, warning=FALSE, message=FALSE}\ndo.call(grid.arrange, args.list)\n```\n\n```{r Process data - var level, include=FALSE, echo=FALSE}\ngrr_v <- melt(GovReportData2014,id.vars = 'country') %>%\n  filter(country %in% countries & variable %in% variables_indiv) %>%\n  group_by(country) %>%\n  mutate(mean = mean(value[variable!='delivery_overallindex100'])) %>%\n  #   mutate(mean = mean(value,na.rm = T)) %>%\n  ungroup() %>%\n  dcast(country + mean ~ variable) %>%\n  melt() %>%\n  group_by(country) %>%\n  mutate(mean = value[variable=='mean']) %>%\n  ungroup() %>%\n  group_by(variable) %>%\n  arrange(value)\n\nvariablesCZ_indiv <- c('Profesionalita','Nestrannost státní správy',\n                 'Efektivita regulací','Regulace bez prodleni',\n                 'Efektivita výběru daní','Schopnost zabraňovat daňovým únikům')\ngrr_v$variable <- revalue(grr_v$variable, c('mean'='Průměr',\n                                        'proff'='Profesionalita',\n                                        'impar'='Nestrannost státní správy',\n                                        'X6.1'='Efektivita regulací',\n                                        'X6.3'='Regulace bez prodleni',\n                                        'a3032'='Efektivita výběru daní',\n                                        'a3033'='Schopnost zabraňovat daňovým únikům'))\n```\n\n```{r Create chart - var level, echo=FALSE, include=FALSE}\n  \ngrr_v$alphaval <- .5\ngrr_v$alphaval[grr$country=='Czech Republic'] <- 1\n\nloadcustomthemes(ifgcolours,'Myriad Pro')\n\nggplot <- function(...) ggplot2::ggplot(...) +\n  scale_fill_manual(values=themebasecolours) +\n  scale_colour_manual(values=themebasecolours)\n\ngrrplots <- mapply(function(x, y) {\n  grr_v2 <- grr_v[grr_v$variable==x,]\n  grr_v2$value[is.na(grr_v2$value)] <- -200\n  grr_v2$country <- with(grr_v2, reorder(country,value))\n  grr_v2$textpos <- ifelse(grr_v2$value>0,grr_v2$value,0)+.1\n  grr_vplot <- ggplot(grr_v2[grr_v2$variable==x,],\n                      aes(country, value,alpha=alphaval)) +\n    geom_bar(stat='identity',position='dodge',fill=y) +\n    geom_text(aes(label=country,y=textpos),hjust=0,size=4) +\n    scale_alpha_identity() +\n    coord_flip() +\n    scale_y_continuous(limits=c(-2,3),\n                       breaks=c(-2,-1,0,1,2,3)) +\n    theme(panel.grid.major.y=element_blank(),panel.grid.minor.x=element_line(),\n          axis.text.y=element_blank(), plot.title=element_text(size=14)) +\n    labs(title=x)\n}, variablesCZ_indiv, themebasecolours[1:6], SIMPLIFY=FALSE)\n\nargs.list <- c(grrplots, 3, 2)\nnames(args.list) <- c(as.character(1:length(grrplots)), \"nrow\", \"ncol\")\n\n```{r Display chart - var level}\ndo.call(grid.arrange, args.list)\n",
    "created" : 1403123093061.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1904045170",
    "id" : "EB949B6",
    "lastKnownWriteTime" : 1403124336,
    "path" : "~/github/local/govcomparative/src/GovReport_CZ_indexes.Rmd",
    "project_path" : "src/GovReport_CZ_indexes.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}